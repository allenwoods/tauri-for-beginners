# 减少应用大小

在应用开发中，减少应用程序的大小对于性能和用户体验至关重要。本章将指导您通过各种策略来实现更小的应用大小。

#### 移除不必要的自定义字体

自定义字体可能会显著增加您的应用程序大小，特别是包含多个字体文件时。考虑不提供自定义字体或使用更现代的替代方案。相反，使用系统字体或大多数设备上已经可用的网络安全字体。这种方法可以节省大量空间。

#### 使用现代图像格式

较旧的图像格式（如 jpeg）可能会不必要地占用大量空间。将您的资源转换为更现代的格式（如 webp 和 webm）可以提供更好的压缩和质量，减少应用程序的整体大小。此外，尽可能使用矢量图形（例如 SVG）是有益的，因为它们与分辨率无关，通常体积更小。

### 优化您的 Rust 配置

在 Rust 中启用某些优化可以显著减少您应用的大小。将以下代码添加到您的 Cargo.toml 文件底部以启用这些优化：

```toml
[profile.dev]
incremental = true # 以更小的步骤编译您的二进制文件。
[profile.release]
codegen-units = 1
lto = true
opt-level = "s" # 优先考虑小的二进制大小。如果您更喜欢速度，请使用 `3`。
panic = "abort" # 通过禁用 panic 处理程序获得更高性能。
strip = true # 确保移除调试符号。
```

#### 说明

codegen-units：减少代码生成单元的数量，允许 LLVM 执行更好的优化，从而产生更小的二进制文件和改进的性能。

- lto（链接时优化）：在链接阶段启用优化，显著减少最终二进制文件的大小。
- opt-level：控制您的优化级别。对于速度，将 opt-level 设置为 3。对于大小，使用 opt-level "s"。"z" 级别在减少大小方面更加激进，但可能会影响性能。
- panic = "abort"：配置应用程序在 panic 时中止而不是展开，通过移除 panic 处理代码来节省空间。
- strip = true：确保从最终二进制文件中移除调试符号，进一步减少其大小。

通过遵循这些步骤，您可以显著减少 Rust 应用程序的大小，从而实现更快的下载速度、减少存储需求并提高性能。

